{"version":3,"sources":["hooks/useSessionStorage.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","demos/Co-reducer-TodoApp.js"],"names":["__webpack_require__","d","__webpack_exports__","useSessionStorage","react__WEBPACK_IMPORTED_MODULE_0__","_ref","key","getter","setter","ref","useRef","useEffect","json","window","sessionStorage","getItem","current","JSON","parse","value","stringify","setItem","_objectWithoutProperties","source","excluded","i","target","sourceKeys","Object","keys","length","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_slicedToArray","arr","Array","isArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","_iterableToArrayLimit","TypeError","_nonIterableRest","App","_useCoreducer2","useCoreducer","costate","action","type","todo","id","Date","now","content","text","completed","todos","hasActiveItem","some","forEach","state","dispatch","assign","co","handleAddTodo","alert","react_default","a","createElement","Fragment","TodoInput","onKeyUp","event","onClick","Todos","Footer","map","Todo","_ref2","_useCoreducer4","edit","remove","handleEdited","onBlur","_ref3","props","objectWithoutProperties","onChange","_ref4","activeItems","filter","completedItems","reverse","item"],"mappings":"yFAAAA,EAAAC,EAAAC,EAAA,sBAAAC,IAAA,IAAAC,EAAAJ,EAAA,GAEe,SAASG,EAATE,GAAoD,IAAvBC,EAAuBD,EAAvBC,IAAKC,EAAkBF,EAAlBE,OAAQC,EAAUH,EAAVG,OACnDC,EAAMC,iBAAO,CAAEJ,MAAKC,SAAQC,WAEhCG,oBAAU,WACR,IAAIC,EAAOC,OAAOC,eAAeC,QAAQT,GAMzC,OAJIM,GACFH,EAAIO,QAAQR,OAAOS,KAAKC,MAAMN,IAGzB,WACL,IAAIO,EAAQF,KAAKG,UAAUX,EAAIO,QAAQT,UACvCM,OAAOC,eAAeO,QAAQf,EAAKa,KAEpC,IAEHR,oBAAU,WACRF,EAAIO,QAAU,CAAEV,MAAKC,SAAQC,WAC5B,CAACF,EAAKC,EAAQC,sCCnBJ,SAAAc,EAAAC,EAAAC,GACf,SAAAD,EAAA,SACA,IACAjB,EAAAmB,EADAC,ECHe,SAAAH,EAAAC,GACf,SAAAD,EAAA,SACA,IAEAjB,EAAAmB,EAFAC,EAAA,GACAC,EAAAC,OAAAC,KAAAN,GAGA,IAAAE,EAAA,EAAaA,EAAAE,EAAAG,OAAuBL,IACpCnB,EAAAqB,EAAAF,GACAD,EAAAO,QAAAzB,IAAA,IACAoB,EAAApB,GAAAiB,EAAAjB,IAGA,OAAAoB,EDTeM,CAA4BT,EAAAC,GAG3C,GAAAI,OAAAK,sBAAA,CACA,IAAAC,EAAAN,OAAAK,sBAAAV,GAEA,IAAAE,EAAA,EAAeA,EAAAS,EAAAJ,OAA6BL,IAC5CnB,EAAA4B,EAAAT,GACAD,EAAAO,QAAAzB,IAAA,GACAsB,OAAAO,UAAAC,qBAAAC,KAAAd,EAAAjB,KACAoB,EAAApB,GAAAiB,EAAAjB,IAIA,OAAAoB,EAjBA1B,EAAAC,EAAAC,EAAA,sBAAAoB,wDEGe,SAAAgB,EAAAC,EAAAd,GACf,OCJe,SAAAc,GACf,GAAAC,MAAAC,QAAAF,GAAA,OAAAA,EDGSG,CAAcH,IEJR,SAAAA,EAAAd,GACf,IAAAkB,EAAA,GACAC,GAAA,EACAC,GAAA,EACAC,OAAAC,EAEA,IACA,QAAAC,EAAAC,EAAAV,EAAAW,OAAAC,cAA6CP,GAAAI,EAAAC,EAAAG,QAAAC,QAC7CV,EAAAW,KAAAN,EAAA7B,QAEAM,GAAAkB,EAAAb,SAAAL,GAH4EmB,GAAA,IAKzE,MAAAW,GACHV,GAAA,EACAC,EAAAS,EACG,QACH,IACAX,GAAA,MAAAK,EAAA,QAAAA,EAAA,SACK,QACL,GAAAJ,EAAA,MAAAC,GAIA,OAAAH,EFnBgCa,CAAoBjB,EAAAd,IGJrC,WACf,UAAAgC,UAAA,wDHGgEC,6CICjD,SAASC,IAAM,IAAAC,EAAAtB,EACJuB,uBACtB,SAACC,EAASC,GACR,GAAoB,aAAhBA,EAAOC,KAAqB,CAC9B,IAAIC,EAAO,CACTC,GAAIC,KAAKC,MACTC,QAASP,EAAQQ,KAAKnD,MACtBoD,WAAW,GAEbT,EAAQU,MAAMlB,KAAKW,GACnBH,EAAQQ,KAAKnD,MAAQ,GAGvB,GAAoB,eAAhB4C,EAAOC,KAAuB,CAChC,IAAIS,EAAgBX,EAAQU,MAAME,KAAK,SAAAT,GAAI,OAAKA,EAAKM,YAErDT,EAAQU,MAAMG,QAAQ,SAAAV,GACpBA,EAAKM,UAAYE,MAIvB,CACED,MAAO,GACPF,KAAM,CACJnD,MAAO,MAxBe,GACvByD,EADuBhB,EAAA,GAChBiB,EADgBjB,EAAA,GA6B5BzD,YAAkB,CAChBG,IAAK,uBACLC,OAAQ,kBAAMqE,GACdpE,OAAQ,SAAAe,GAAM,OAAIK,OAAOkD,OAAOC,aAAGH,GAAQrD,MAG7C,IAAIyD,EAAgB,WAClB,IAAKJ,EAAMN,KAAKnD,MACd,OAAO8D,MAAM,iBAEfJ,EAAS,CAAEb,KAAM,cAanB,OACEkB,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACEH,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACE,EAAD,CAAWhB,KAAMM,EAAMN,KAAMiB,QATjB,SAAAC,GACE,UAAdA,EAAMlF,KACR0E,OAQEE,EAAAC,EAAAC,cAAA,UAAQK,QAAST,GAAjB,OACAE,EAAAC,EAAAC,cAAA,UAAQK,QAfQ,WACpBZ,EAAS,CAAEb,KAAM,iBAcb,eAEFkB,EAAAC,EAAAC,cAACM,EAAD,CAAOlB,MAAOI,EAAMJ,QACpBU,EAAAC,EAAAC,cAACO,EAAD,CAAQnB,MAAOI,EAAMJ,SAK3B,SAASkB,EAATrF,GAA0B,IAATmE,EAASnE,EAATmE,MACf,OACEU,EAAAC,EAAAC,cAAA,UACGZ,EAAMoB,IAAI,SAAA3B,GACT,OAAOiB,EAAAC,EAAAC,cAACS,EAAD,CAAMvF,IAAK2D,EAAKC,GAAID,KAAMA,OAMzC,SAAS4B,EAATC,GAAwB,IAAR7B,EAAQ6B,EAAR7B,KAAQ8B,EAAAzD,EACEuB,uBACtB,SAACC,EAASC,GACY,SAAhBA,EAAOC,OACTF,EAAQkC,KAAK7E,OAAQ,EACrB2C,EAAQQ,KAAKnD,MAAQ8C,EAAKI,SAGR,WAAhBN,EAAOC,OACTF,EAAQkC,KAAK7E,OAAQ,EACrB4D,aAAGd,GAAMI,QAAUP,EAAQQ,KAAKnD,OAGd,WAAhB4C,EAAOC,MACTiC,iBAAOlB,aAAGd,IAGQ,WAAhBF,EAAOC,OACTe,aAAGd,GAAMM,WAAaN,EAAKM,YAG/B,CACEyB,KAAM,CACJ7E,OAAO,GAETmD,KAAM,CACJnD,MAAO,MA1BS,GACjByD,EADiBmB,EAAA,GACVlB,EADUkB,EAAA,GAmClBG,EAAe,WACjBrB,EAAS,CAAEb,KAAM,YAiBnB,OACEkB,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAAA,UAAQK,QAVO,WACjBZ,EAAS,CAAEb,KAAM,aASf,UACAkB,EAAAC,EAAAC,cAAA,UAAQK,QAPO,WACjBZ,EAAS,CAAEb,KAAM,aAOZC,EAAKM,UAAY,YAAc,UAEjCK,EAAMoB,KAAK7E,OACV+D,EAAAC,EAAAC,cAACE,EAAD,CACEhB,KAAMM,EAAMN,KACZ6B,OAAQD,EACRX,QAxBU,SAAAC,GACE,UAAdA,EAAMlF,KACR4F,QAyBEtB,EAAMoB,KAAK7E,OAAS+D,EAAAC,EAAAC,cAAA,QAAMK,QAnCf,WACfZ,EAAS,CAAEb,KAAM,WAkCmCC,EAAKI,UAK7D,SAASiB,EAATc,GAAuC,IAAlB9B,EAAkB8B,EAAlB9B,KAAS+B,EAASzE,OAAA0E,EAAA,EAAA1E,CAAAwE,EAAA,UAIrC,OACElB,EAAAC,EAAAC,cAAA,QAAAxD,OAAAkD,OAAA,CAAOd,KAAK,QAAWqC,EAAvB,CAA8BE,SAJb,SAAAf,GACjBT,aAAGT,GAAMnD,MAAQqE,EAAM9D,OAAOP,OAGwBA,MAAOmD,EAAKnD,SAItE,SAASwE,EAATa,GAA2B,IAAThC,EAASgC,EAAThC,MACZiC,EAAcjC,EAAMkC,OAAO,SAAAzC,GAAI,OAAKA,EAAKM,YACzCoC,EAAiBnC,EAAMkC,OAAO,SAAAzC,GAAI,OAAIA,EAAKM,YAO/C,OACEW,EAAAC,EAAAC,cAAA,WACGqB,EAAY3E,OADf,QAC4B2E,EAAY3E,OAAS,GAAK,IADtD,UACkE,IAC/D6E,EAAe7E,OAAS,GACvBoD,EAAAC,EAAAC,cAAA,UAAQK,QATa,WACJjB,EAAMkC,OAAO,SAAAzC,GAAI,OAAIA,EAAKM,YAChCqC,UAAUjC,QAAQ,SAAAkC,GAAI,OAAIZ,iBAAOlB,aAAG8B,QAO/C","file":"static/js/3.75569a49.chunk.js","sourcesContent":["import { useRef, useEffect } from 'react'\r\n\r\nexport default function useSessionStorage({ key, getter, setter }) {\r\n  let ref = useRef({ key, getter, setter })\r\n\r\n  useEffect(() => {\r\n    let json = window.sessionStorage.getItem(key)\r\n\r\n    if (json) {\r\n      ref.current.setter(JSON.parse(json))\r\n    }\r\n\r\n    return () => {\r\n      let value = JSON.stringify(ref.current.getter())\r\n      window.sessionStorage.setItem(key, value)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    ref.current = { key, getter, setter }\r\n  }, [key, getter, setter])\r\n}\r\n","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import React from 'react'\r\nimport { co, remove } from 'costate'\r\nimport { useCoreducer } from 'costate/react'\r\nimport useSessionStorage from '../hooks/useSessionStorage'\r\n\r\nexport default function App() {\r\n  let [state, dispatch] = useCoreducer(\r\n    (costate, action) => {\r\n      if (action.type === 'ADD_TODO') {\r\n        let todo = {\r\n          id: Date.now(),\r\n          content: costate.text.value,\r\n          completed: false\r\n        }\r\n        costate.todos.push(todo)\r\n        costate.text.value = ''\r\n      }\r\n\r\n      if (action.type === 'TOGGLE_ALL') {\r\n        let hasActiveItem = costate.todos.some(todo => !todo.completed)\r\n\r\n        costate.todos.forEach(todo => {\r\n          todo.completed = hasActiveItem\r\n        })\r\n      }\r\n    },\r\n    {\r\n      todos: [],\r\n      text: {\r\n        value: ''\r\n      }\r\n    }\r\n  )\r\n\r\n  useSessionStorage({\r\n    key: 'coreducer-todos-json',\r\n    getter: () => state,\r\n    setter: source => Object.assign(co(state), source)\r\n  })\r\n\r\n  let handleAddTodo = () => {\r\n    if (!state.text.value) {\r\n      return alert('empty content')\r\n    }\r\n    dispatch({ type: 'ADD_TODO' })\r\n  }\r\n\r\n  let handleToggleAll = () => {\r\n    dispatch({ type: 'TOGGLE_ALL' })\r\n  }\r\n\r\n  let handleKeyUp = event => {\r\n    if (event.key === 'Enter') {\r\n      handleAddTodo()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <TodoInput text={state.text} onKeyUp={handleKeyUp} />\r\n        <button onClick={handleAddTodo}>add</button>\r\n        <button onClick={handleToggleAll}>toggle-all</button>\r\n      </div>\r\n      <Todos todos={state.todos} />\r\n      <Footer todos={state.todos} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Todos({ todos }) {\r\n  return (\r\n    <ul>\r\n      {todos.map(todo => {\r\n        return <Todo key={todo.id} todo={todo} />\r\n      })}\r\n    </ul>\r\n  )\r\n}\r\n\r\nfunction Todo({ todo }) {\r\n  let [state, dispatch] = useCoreducer(\r\n    (costate, action) => {\r\n      if (action.type === 'EDIT') {\r\n        costate.edit.value = true\r\n        costate.text.value = todo.content\r\n      }\r\n\r\n      if (action.type === 'EDITED') {\r\n        costate.edit.value = false\r\n        co(todo).content = costate.text.value\r\n      }\r\n\r\n      if (action.type === 'REMOVE') {\r\n        remove(co(todo))\r\n      }\r\n\r\n      if (action.type === 'TOGGLE') {\r\n        co(todo).completed = !todo.completed\r\n      }\r\n    },\r\n    {\r\n      edit: {\r\n        value: false\r\n      },\r\n      text: {\r\n        value: ''\r\n      }\r\n    }\r\n  )\r\n\r\n  let handleEdit = () => {\r\n    dispatch({ type: 'EDIT' })\r\n  }\r\n\r\n  let handleEdited = () => {\r\n    dispatch({ type: 'EDITED' })\r\n  }\r\n\r\n  let handleKeyUp = event => {\r\n    if (event.key === 'Enter') {\r\n      handleEdited()\r\n    }\r\n  }\r\n\r\n  let handleRemove = () => {\r\n    dispatch({ type: 'REMOVE' })\r\n  }\r\n\r\n  let handleToggle = () => {\r\n    dispatch({ type: 'TOGGLE' })\r\n  }\r\n\r\n  return (\r\n    <li>\r\n      <button onClick={handleRemove}>remove</button>\r\n      <button onClick={handleToggle}>\r\n        {todo.completed ? 'completed' : 'active'}\r\n      </button>\r\n      {state.edit.value && (\r\n        <TodoInput\r\n          text={state.text}\r\n          onBlur={handleEdited}\r\n          onKeyUp={handleKeyUp}\r\n        />\r\n      )}\r\n      {!state.edit.value && <span onClick={handleEdit}>{todo.content}</span>}\r\n    </li>\r\n  )\r\n}\r\n\r\nfunction TodoInput({ text, ...props }) {\r\n  let handleChange = event => {\r\n    co(text).value = event.target.value\r\n  }\r\n  return (\r\n    <input type=\"text\" {...props} onChange={handleChange} value={text.value} />\r\n  )\r\n}\r\n\r\nfunction Footer({ todos }) {\r\n  let activeItems = todos.filter(todo => !todo.completed)\r\n  let completedItems = todos.filter(todo => todo.completed)\r\n\r\n  let handleClearCompleted = () => {\r\n    let completedItems = todos.filter(todo => todo.completed)\r\n    completedItems.reverse().forEach(item => remove(co(item)))\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {activeItems.length} item{activeItems.length > 1 && 's'} left |{' '}\r\n      {completedItems.length > 0 && (\r\n        <button onClick={handleClearCompleted}>Clear completed</button>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}